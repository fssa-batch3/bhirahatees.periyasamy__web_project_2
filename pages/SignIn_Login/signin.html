<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Sign - In | Host</title>
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/css/bootstrap.min.css"
      rel="stylesheet"
      integrity="sha384-GLhlTQ8iRABdZLl6O3oVMWSktQOp6b7In1Zl3/Jr59b6EGGoI1aFkw7cmDA6j6gD"
      crossorigin="anonymous"
    />
    <link rel="stylesheet" href="../../assets/css/style.css" />
    <link rel="stylesheet" href=../../assets/css/sign-in.css>
  </head>
  <style>
    input:valid {
      box-shadow: inset 0 1px 1px rgb(0, 255, 0), 0 0 8px rgba(7, 188, 46, 0.6);
    }

    input:invalid {
      box-shadow: inset 0 1px 1px rgb(228, 19, 19), 0 0 8px rgba(236, 8, 8, 0.6);
    }
  </style>
  <body>
    <header>
      <!-- using symantic tags -->
      <nav class="navbar header">
        <!-- navbar -->
        <div class="container">
          <a class="navbar-brand" href="../../index.html">
            <img class="logo" src="#" alt="#" />
          </a>
        </div>
      </nav>
    </header>
    <!-- signin-card-->
    <section class="signin-section">
      <!-- creating a card using bootstrap -->
      <div class="create-heading"><h3>Create Your Workspace</h3></div>
      <div class="container-fluid">
        <form class="sign-in-card" action="">
          <div class="container-fluid">
            <div class="form-floating mb-3 name input">
              <input
                type="text"
                class="form-control first-name text"
                id="floatingInput"
                pattern="^[a-zA-Z][a-zA-Z0-9-_\.]{1,20}$"
                placeholder="Steve"
                required
              />
              <label for="floatingInput">First Name</label>
            </div>
            <div class="form-floating mb-3 input">
              <input
                type="text"
                class="form-control text last-name"
                pattern="^[a-zA-Z][a-zA-Z0-9-_\.]{1,20}$"
                id="floatingInput"
                placeholder="Rogers"
                required
              />
              <label for="floatingInput">Last Name</label>
            </div>
          </div>
          <div class="signin-email">
            <div class="form-floating mb-3 input">
              <input
                type="email"
                class="form-control email"
                id="floatingInput"
                placeholder="name@example.com"
                required
              />
              <label for="floatingInput">Email address</label>
            </div>
          </div>
          <div class="signin-key">
            <div class="form-floating mb-3 input">
              <input
                type="text"
                class="form-control key"
                id="floatingInput"
                placeholder="name@example.com"
                required
              />
              <label for="floatingInput">Sharing Key (optional)</label>
            </div>
          </div>
          <div class="sign-in-pass container-fluid">
            <div class="form-floating name">
              <input
                type="password"
                class="form-control text password"
                id="floatingPassword password"
                pattern="^(?=.*\d)(?=.*[a-z])(?=.*[A-Z])(?!.*\s).*$"
                placeholder="Password"
                required
              />
              <label for="floatingPassword">Password</label>
            </div>
            <div class="form-floating name">
              <input
                type="password"
                class="form-control text confo-password"
                id="floatingPassword"
                placeholder="Password"
                required
              />
              <label for="floatingPassword">Confirm Password</label>
            </div>
          </div>
          <div class="log-in-btn container">
            <button
              type="button"
              id="sign-in-btn"
              class="btn btn-primary log-btn"
            >
              Sign In
            </button>
          </div>
        </form>
        <img
          src="../../assets/images/12281509_4942219.jpg"
          class="img-fluid sign-in-image"
        />
      </div>
      <a href="../Ticket Page/dashboard.html"></a>
    </section>
  </body>
  <script></script>
  <script>
    document.getElementById("sign-in-btn").addEventListener("click", (e) => {
      let arr = [];
      let existDatas = JSON.parse(localStorage.getItem("signinData"));
      let validation = false;
      let data = new Object();

      data["name"] =
        document.querySelector(".first-name").value.trim() +
        " " +
        document.querySelector(".last-name").value.trim();
      console.log(name);
      data.profileLink =
        "https://images-wixmp-ed30a86b8c4ca887773594c2.wixmp.com/f/89f9adda-0ce2-41ca-bd0a-629c69bba8e5/dapuv77-136f3b3e-66ea-4d43-9bbd-e38008c80c4f.png/v1/fill/w_1024,h_1191,strp/deadpool_png__3_by_anna_x_anarchy_dapuv77-fullview.png?token=eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJzdWIiOiJ1cm46YXBwOjdlMGQxODg5ODIyNjQzNzNhNWYwZDQxNWVhMGQyNmUwIiwiaXNzIjoidXJuOmFwcDo3ZTBkMTg4OTgyMjY0MzczYTVmMGQ0MTVlYTBkMjZlMCIsIm9iaiI6W1t7ImhlaWdodCI6Ijw9MTE5MSIsInBhdGgiOiJcL2ZcLzg5ZjlhZGRhLTBjZTItNDFjYS1iZDBhLTYyOWM2OWJiYThlNVwvZGFwdXY3Ny0xMzZmM2IzZS02NmVhLTRkNDMtOWJiZC1lMzgwMDhjODBjNGYucG5nIiwid2lkdGgiOiI8PTEwMjQifV1dLCJhdWQiOlsidXJuOnNlcnZpY2U6aW1hZ2Uub3BlcmF0aW9ucyJdfQ.TrD-FIdUthi-6Mnxfv0H4QR0Qhp5QJENX2DhEpiZXQ8";
      data["email"] = document.querySelector(".email").value.toLowerCase();
      data["key"] = document.querySelector(".key").value.trim();
      data["password"] = document.querySelector(".password").value.trim();
      data["organization"] = "Add";
      data["position"] = "Add";
      if (document.querySelector(".key").value === null) {
        data["key"] = crypto.randomUUID();
      }
      if (existDatas !== null) {
        validation = existDatas.find((o) => o["email"] === data["email"]);
      }
      if (
        data.password.trim() !==
        document.querySelector(".confo-password").value.trim()
      ) {
        document.querySelector(".confo-password").style.boxShadow =
          "inset 0 1px 1px rgb(228, 19, 19), 0 0 8px rgba(236, 8, 8, 0.6)";
        return alert("Password Not Match");
      }

      if (validation) {
        return alert("User Already Exists");
      } else {
        if (existDatas !== null) {
          existDatas.push(data);
          window.localStorage.setItem("signinData", JSON.stringify(existDatas));
          window.location.href = "./login.html";
        } else {
          arr.push(data);
          window.localStorage.setItem("signinData", JSON.stringify(arr));
          window.location.href = "./login.html";
        }
      }
    });
  </script>
</html>
