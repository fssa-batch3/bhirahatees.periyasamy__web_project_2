<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Log In - Untitled</title>
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/css/bootstrap.min.css"
      rel="stylesheet"
      integrity="sha384-GLhlTQ8iRABdZLl6O3oVMWSktQOp6b7In1Zl3/Jr59b6EGGoI1aFkw7cmDA6j6gD"
      crossorigin="anonymous"
    />
    <link rel="stylesheet" href="../../assets/css/style.css" /></head
  ><style>
    input:valid {
      box-shadow: inset 0 1px 1px rgb(0, 255, 0), 0 0 8px rgba(7, 188, 46, 0.6);
    }

    input:invalid {
      box-shadow: inset 0 1px 1px rgb(228, 19, 19), 0 0 8px rgba(236, 8, 8, 0.6);
    }
  </style>
  <body>
    <header>
      <!-- using symantic tags -->
      <nav class="navbar header">
        <!-- navbar -->
        <div class="container">
          <a class="navbar-brand" href="../../index.html">
            <img class="logo" src="#" alt="#" />
          </a>
        </div>
      </nav>
    </header>
    <section class="login-section">
      <!-- create card using bootstrap -->
      <div class="login-card">
        <form>
          <div class="form-floating mb-3 input">
            <input
              type="email"
              class="form-control email"
              id="floatingInput user-email"
              placeholder="name@example.com"
            />
            <label for="floatingInput">Email address</label>
          </div>
          <div class="form-floating">
            <input
              type="password"
              class="form-control password"
              id="floatingPassword user-password"
              placeholder="Password"
            />
            <label for="floatingPassword">Password</label>
          </div>
          <a class="for-pass" href="#">Forgot Password ?</a>
          <button id="login-btn" class="btn login-btn">Log in</button>
        </form>
      </div>
    </section>
  </body>
  <script>
    let userData = JSON.parse(window.localStorage.getItem("signinData"));

    document.getElementById("login-btn").addEventListener("click", (e) => {
      e.preventDefault();
      let email = document.querySelector(".email").value.toLowerCase();
      let password = document.querySelector(".password").value;
      let data;
      for (let i = 0; i < userData.length; i++) {
        let valid = userData[i]["members"].find(
          (validation) => email === validation["email"]
        );
        if (valid !== undefined) {
          data = valid;
        }
      }
      console.log(userData, data);
      if (email === null && password === null) {
        return alert("Invallid Details");
      } else if (data === undefined) {
        return alert("invalid user or email");
      } else if (data["email"] === email && data["password"] === password) {
        console.log("pass");
        localStorage.setItem("userEmail", email);
        window.location.href = "../Ticket Page/dashboard.html";
        return alert("success");
      }
    });
  </script>
</html>
